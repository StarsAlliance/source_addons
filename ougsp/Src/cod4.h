#ifndef _COD4_H_
#define _COD4_H_

#include <string.h>
#include "vupshared.h"

#define COD4ShortVerMagic "{55 : 8B EC : 83 E4 F8 : 83 EC 1C : 53 : 56 : 57 _: 68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : \
                            68 ?? ?? ?? 00 :_ 6A 10 : E8 ?? ?? FF FF : 8B 45 08 : E8 ?? ?? FF FF : E8 ?? ?? ?? 00 : E8 ?? ?? ?? 00 : E8 ?? ?? FF FF : \
                            E8 ?? ?? FF FF : 6A 00 : E8 ?? ?? FF FF : 83 C4 1C ^ \
                            55 : 89 E5 : 57 : 56 : 53 : 83 EC 1C _: C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? ?? ?? ?? : \
                            C7 44 24 ?? ?? ?? ?? ?? : C7 04 24 ?? ?? ?? ?? :_ E8 ?? ?? FF FF : C7 44 24 ?? ?? ?? ?? ?? : C7 04 24 ?? ?? ?? ?? : \
                            E8 ?? ?? F? FF : 85 C0}"

#define COD4FullVerMagic_WiN "68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? ?? : E8 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? ?? : \
                              68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : 68 ?? ?? ?? 00 : E8 ?? ?? ?? 00 : 83 C4 24 : BF ?? ?? ?? 00 : 89 44 24 10 : 33 F6 : \
                              E8 ?? ?? ?? 00"


#define COD4FullVerMagic_Unix_1 "E8 ?? ?? F? FF : E8 ?? ?? F? FF : C7 44 24 ?? ?? ?? ?? ?? : 89 44 24 0C : C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? ?? ?? ?? : \
                                 C7 04 24 ?? ?? ?? ?? : E8 ?? ?? ?? 00 : 89 C3 : C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? 00 00 00 : C7 44 24 ?? ?? ?? ?? ?? : \
                                 C7 04 24 ?? ?? ?? ??"

#define COD4FullVerMagic_Unix_2 "55 : 89 E5 : 83 EC 18 : C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? ?? ?? ?? : C7 44 24 ?? ?? ?? ?? ?? : \
                                 C7 04 24 ?? ?? ?? ?? : E8 ?? ?? F? FF : B8 ?? ?? ?? ?? : C9 : C3"


#define COD4DenyJunction_Win "8B 54 24 14 : 68 ?? ?? ?? 00 : B8 FF FF FF ?? : E8 ?? ?? ?? 00 : 83 C4 04 : 85 C0 _: 0F ?? ?? ?? 00 00 :_ 85 DB _: \
                              0F ?? ?? ?? 00 00_ : 38 03 _: 0F ?? ?? ?? 00 00 :_ 68 ?? ?? ?? 00 : B8 FF FF FF ?? : 8B D3 : E8 ?? ?? ?? 00"

#define COD4DenyJunction_Unix "C7 44 24 04 ?? ?? ?? ?? : 8B 85 ?? ?? FF FF : 89 04 24 : E8 ?? ?? ?? 00 : 85 C0 : 0F 85 06 01 00 00 : \
                               8B ?? ?? ?? FF FF : 85 ?? : 74 0F : 8B 85 ?? ?? FF FF : 80 38 00 : 0F 85 A4 01 00 00"

#define COD4GUIDComparision_Win "85 C0 _: 74 ?? :_ 55 : 57 : 68 ?? ?? ?? 00 : 6A 0F : E8 ?? ?? F? FF : 8B ?? ?? ?? ?? ?? : 8D ?? ?? ?? ?? ?? : 51 : 8B 0E : \
                                 8B C4 : 89 08 : 8B 4E 08 : 89 50 04 : 8B 56 0C : 89 48 08 : 8B 4E 10 : 89 50 0C : 89 48 10 : B8 ?? ?? ?? 00"


#define COD4AcceptAllChecks_Win "85 C0 _: 75 ?? :_ 39 ?? ?? ?? ?? ?? _: 0F 85 ?? ?? 00 00 :_"
#define COD4AcceptCDKeyCheck_Lin "85 C0 _: 0F 85 ?? ?? 00 00 :_"
#define COD4AcceptSilentDrop_Lin "85 D2 _: 0F 85 ?? ?? FF FF :_"
#define COD4Accept_Dst "66 8B C0 66 8B C0"
#define COD4Accept_Dst2 "89 C0"



TBOOL IfCOD4Engine(TSTREAMADDR_HDR const fileStream,const TVUP_OSType fileOS,char Version[200]);

void PatchCOD4Engine(TSTREAMADDR_HDR const fileStream,const TVUP_OSType fileOS,TBOOL PromtUser,TBOOL ClientChecks,TBOOL *PatchingResult,char Version[200]);




#endif
