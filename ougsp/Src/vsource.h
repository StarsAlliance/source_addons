#ifndef _VSOURCE_H_
#define _VSOURCE_H_

#include <string.h>
#include "vupshared.h"
#include "vlvshared.h"


#define VLVSSteamValidation_Src "{8B 44 24 ?? : 8B 4C 24 ?? : 8B 54 24 ?? : 50 : 51 : 8B ?? ?? ?? [00 00] : 56 : 52 : 8D 44 24 20 : 50 : [83 C1 ??] : 51 : 57 : E8 ?? ?? ?? 00 : \
                                 8B C8 : E8 ?? ?? ?? 00 : 84 C0 _: 75 ?? :_ 8B 15 ?? ?? 5? 20 : 83 7A 2C 00 : 75 ?? : 8B 45 00 : 68 ?? ?? 2? 20 : 53 : E9 ?? FF FF FF ^ \
                                 89 54 24 0C : 89 6C 24 08 : 89 04 24 : E8 ?? ?? F? FF : 84 C0 _: 0F 85 ?? F? FF FF :_ A1 18 00 00 00 : 8B 78 2C : 85 FF : \
                                 0F 85 ?? F? FF FF : 8B 03 : BF ?? ?? ?? 00 : 89 7C 24 08 : E9 ?? F? FF FF ^ \
                                 50 : E8 ?? ?? F? FF : 83 C4 20 : 84 C0 _: 0F 85 ?? ?? ?? FF :_ 8B 15 18 00 00 00 : 8B 7A 2C : 85 FF : 0F 85 ?? ?? ?? FF : \
                                 50 : 8B 03 : 68 ?? ?? ?? 00 : E9 ?? ?? F? FF}"

#define VLVSSteamValidation_Win_Dst "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? \
                                     ?? ?? ?? ?? ?? ?? ?? ?? EB ?? ?? ?? ??"
#define VLVSSteamValidation_UNiX_Dst "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 90 E9 ?? ?? ?? ??"
#define VLVSSteamValidation_UNiX_AMD_Dst "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 90 E9 ?? ?? ?? ??"


#define VLVSLANChk_Src "{53 : 55 : 8B CE : FF ?? ?? 00 00 00 : 84 C0 : 75 ?? : 8B 06 : 68 ?? ?? ?? ?0 : 55 : 56 : FF ?? ?? 00 00 00 : \
                        83 C4 0C : 5B : 5D : 5F : 33 C0 : 5E : C2 28 00 ^ \
                        8B 54 24 38 : 8B 7D 00 : 89 2C 24 : 89 54 24 04 : FF ?? ?? 00 00 00 : 84 C0 : 74 ?? : 8B 74 24 60 : 8B 4C 24 38 : 8B 45 00 : \
                        89 74 24 08 : 89 4C 24 04 : 89 2C 24 : FF ?? ?? 00 00 00 : 84 C0 _: 0F ?? ?? 00 00 00 : 8B 4C 24 64 ^ \
                        83 C4 10 : 84 C0 : 0F 84 ?? ?? 00 00 : 57 : 8B 45 00 : FF 74 24 34 : FF 74 24 10 : 55 : FF 90 ?? ?? 00 00 : \
                        83 C4 10 : 84 C0 : _0F 84 ?? ?? ?? ??_ 8B 75 00 : FF 74 24 34 53}"


#define VLVSLANChk_WinDst "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? EB ?? ?? ?? ?? ?? ?? ??"
#define VLVSLANChk_UNiXDst "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? \
                              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 66 89 C0 66 89 C0 ?? ??"

#define VLVSLANChk_UNiXDstAMD "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? \
                               ?? ?? ?? ?? ?? 66 89 C0 66 89 C0 ?? ??"

#define VLVSServerReqSteam_Src "{56 : 8B F1 : 8B 0D ?? ?? ?? 10 : 8B 01 : 8B 50 14 : FF D2 : 84 C0 _: 75 ?? :_ 68 ?? ?? 2A 10 : \
                                  6A 01 : E8 ?A ?? F7 FF : 8B 06 : 8B 50 34 83 : C4 08 ^ \
                                  89 5C 24 10 : E8 ?? ?? FE FF : 81 C3 ?? ?? ?? 00 : 89 74 24 14 : 8B 8B ?? ?? 00 00 : 8B 74 24 20 : \
                                  89 7C 24 18 : 8B 01 : 8B 7C 24 24 : 8B 10 : 89 04 24 : FF 52 14 : 84 C0 : 0F 84 86 00 00 00 : 8D 57 FF : \
                                  81 FA FE 07 00 00 : 77 3B : 8D 8B ?? ?? F6 FF : 89 0C 24 : E8 ?? ?? FE FF}"
#define VLVSServerReqSteam_Dst_Win "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? EB"
#define VLVSServerReqSteam_Dst_Unix "?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? \
                                       ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 66 89 C0 66 89 C0"


#define VLVSJMPTabHelper "{ CC CC CC : 8B 44 24 08 : 83 C0 FF : 83 F8 0D : 0F ?? ?? ?? 00 00 : FF 24 85 ?? ?? 1? ?0 : 8B 44 24 04 :\
                            8B 48 04 : 83 C0 04 : 68 ?? ?? ?? ?0 : 50 : FF 51 30 : 83 C4 08 : C2 0C 00 : 8B ?? ?? ?? ?? ?0 : 83 7A 2C 00 : 0F 85 ?? ?? 00 00 :\
                            8B 44 24 04 : 8B 48 04 : 83 C0 04 ^ \
                            90 8D B4 26 00 00 00 00 : 8D BC 27 00 00 00 00 : 83 EC 0C : 8B 44 24 18 : 8B 4C 24 14 : 8B 54 24 1C : 83 F8 0E _: 77 ?? : FF ?? 85 ?? ?? ?? ?? :_\
                            __90 8D 74 26 00__ : 8B 01 : BA ?? ?? ?? 00 : 89 54 24 04 : 89 0C 24 : FF 50 38 _: 83 C4 0C : C3 :: ^ \
                            8B 44 24 0C : 8B 4C 24 08 : 83 F8 0E : 8B 54 24 10 : 77 ?? _: FF 24 85 ?? ?? ?? ?? : 90 8D B4 26 00 00 00 00 : 8B 01 : \
                            C7 44 24 ?? ?? ?? ?? 00 : 89 4C 24 04 : 8B 48 38 : FF ?? : 8D B6 00 00 00 00 8D BC 27 00 00 00 00 : A1 18 00 00 00 : \
                            8B 50 2C : 85 D2 : 74 ?? _: C3 ;_ }"

#define VLVSCheckDuplicateSteamIDFunc "{A1 ?? ?? ?? ?? : 83 78 2C 00 : 89 4C 24 ?? : C6 44 24 ?? 00 _: 74 ?? :_ 32 C0 ^ \
                                        31 DB : 8B 0D ?? ?? ?? ?? : 8B 6C 24 ?? : 8B 41 2C : 85 C0 _: 75 ?? :_ 8B 15 ?? ?? ?? ?? : 31 FF : 85 D2 : 7F ?? : 90 : \
                                        8D B4 26 00 00 00 00 : 0F B6 D3 ^ \
                                        ?? ?? : 8B 0D ?? ?? ?? ?? : 8B 6C 24 ?? : 8B 41 2C : 85 C0 _: 75 ?? :_ 8B 15 ?? ?? ?? ?? : BF 00 00 00 00 : 85 D2 : 7F ?? : 89 F6 : 0F B6 D3}"




TBOOL IfSrcEngine(TSTREAMADDR_HDR const fileStream,const TVUP_OSType fileOS,char Version[200]);

void PatchSrcEngine(TSTREAMADDR_HDR const fileStream,const TVUP_OSType fileOS,TBOOL PromtUser,TBOOL ClientChecks,TBOOL *PatchingResult,char Version[200]);


#endif
